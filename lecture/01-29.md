

Technique: A good way to understand a machine learning model, and the software that implements it, is to generate data that satisfies the assumptions of the model and check that the model gives you the results you expect.
Let's do that for clustering.

We'll start by generating 2 dimensional data that has 3 clusters around the points (0, 0), (1, 0), (0, 1).
We use 2 dimensions so that we can actually see the clusters.

```{r}
n = 100

# Makes this reproducible.
set.seed(489)
true_cluster = sample(1:3, size = n, replace = TRUE)

x = rep(0, n)
y = rep(0, n)

x[true_cluster == 2] = 1
y[true_cluster == 3] = 1

# Right now the points all overlap, so add some noise
x = x + rnorm(n, sd = 0.1)
y = y + rnorm(n, sd = 0.1)

plot(x, y)

# Better
plot(x, y, pch = true_cluster)
```

The goal of clustering is simple if vague: partition the data into groups.

Now we'll play around with some algorithms.
I'm using the `cluster` package that comes as a recommended package with R.

```{r}
library(cluster)

# Modeling functions tend to play better with data frames.
xy = data.frame(x, y)

p1 = pam(xy, k = 3L)
```

`pam` is an acronym for Partitioning Around Medoids.

The basic idea: find k data points to be the medoids of the clusters, and assign all the other points to the closest medoid.
Do this in a way that minimizes the total distance between points and their assigned medoids.

A medoid is generalization of median- i.e. the data point that lies in the 'center' of the data, according to some measure of distance.

Reading the documentation we see that the software saves the cluster assignments into `clustering`.
```{r}
mean(p1$clustering == true_cluster)
```

What, the clustering doesn't match the true clustering!
Question: What's going on?
The clusters are the same up to labeling.

We can add them to the plot:

```{r}
with(xy, points(x, y, pch = p1$clustering))
```

```{r}

p1 = pam(xy, k = 3L, trace.lev=2)

```

Silhouettes are pretty cool, you can read about them.

Reference: Silhouettes: A graphical aid to the interpretation and validation of cluster analysis by Peter J.Rousseeuw



